{"remainingRequest":"/Users/erin/project/hello-world/testSrc/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/erin/project/hello-world/testSrc/src/components/mapDrag.vue?vue&type=style&index=0&id=51702a60&lang=less&scoped=true&","dependencies":[{"path":"/Users/erin/project/hello-world/testSrc/src/components/mapDrag.vue","mtime":1611765541808},{"path":"/Users/erin/project/hello-world/testSrc/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/erin/project/hello-world/testSrc/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/erin/project/hello-world/testSrc/node_modules/postcss-loader/lib/index.js","mtime":499162500000},{"path":"/Users/erin/project/hello-world/testSrc/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/erin/project/hello-world/testSrc/node_modules/cache-loader/dist/cjs.js","mtime":1611492586366},{"path":"/Users/erin/project/hello-world/testSrc/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n@import \"../assets/css/var.less\";\n  .m-map{\n    height: 100vh;\n    width: 100vh;\n    .map{\n      width: 100vh;\n      height: 100vh;\n    }\n\n  }\n  .input_card{\n    position: absolute;\n    background-color: white;\n    filter: opacity(0.8);\n    height: 40vh;\n    width: 100vh;\n    bottom: 0;\n    border-radius: 20px 20px 0 0;\n    z-index: 9999;\n    font-weight: bold;\n    .duration();\n\n  }\n  .top_location{\n    top: 10px;\n    height: 100%;\n  }\n.input_card1{\n  position: absolute;\n  height: 40vh;\n  width: 100vh;\n  bottom: 0;\n  border-radius: 20px 20px 0 0;\n  z-index: 998;\n  .blur(3px);\n}\n",{"version":3,"sources":["mapDrag.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"mapDrag.vue","sourceRoot":"src/components","sourcesContent":["<!--\n  描述：拖放地图组件，默认尺寸是 500 * 300\n\n  接收属性参数：\n    lat: 纬度\n    lng: 经度\n\n  自定义事件：\n    drag: 拖放完成事件\n\n  示例：\n    <mapDrag @drag=\"dragMap\" lat=\"22.574405\" lng=\"114.095388\"></mapDrag>\n-->\n<template>\n  <div>\n    <div class=\"m-map\">\n      <div id=\"js-container\" class=\"map\">\n        正在加载数据 ...\n      </div>\n\n    </div>\n    <div  @click=\"testDialog\">测试dialog</div>\n\n    <div class=\"input_card\"  @touchstart=\"touchstart\" @touchend=\"touchend\" :class=\"{'top_location':!isBottom}\" >\n      测试ing\n      毛玻璃效果\n      <div>{{$lang('userName')}}</div>\n      <div>{{$lang('message')}}</div>----{{$t('status')}}\n    </div>\n    <div class=\"input_card1\" ref=\"card\"  @touchstart=\"touchstart\" @touchend=\"touchend\" :class=\"{'top_location':!isBottom}\"></div>\n  </div>\n</template>\n\n<script>\n  import remoteLoad from '@/utils/remoteLoad.js'\n  import { MapKey, MapCityName } from '@/config/config'\n  import testData from  '@/mock.js'\n  import dialog from \"../utils/dialog\";\n  export default {\n    props: ['lat', 'lng'],\n    data () {\n      return {\n        searchKey: '',\n        placeSearch: null,\n        dragStatus: false,\n        AMapUI: null,\n        AMap: null,\n        startY:0,\n        isBottom:true,\n        lang: 'zh-CN'\n      }\n    },\n    watch: {\n      searchKey () {\n        if (this.searchKey === '') {\n          this.placeSearch.clear()\n        }\n      }\n    },\n    mounted(){\n\n    },\n    methods: {\n      setLang(lang){\n        this.$common.setLang(lang);\n        this.$forceUpdate();\n      },\n      testDialog(){\n        if (this.lang === 'zh-CN') {\n          this.lang = 'en-US'\n          this.$i18n.locale = this.lang\n        } else {\n          this.lang = 'zh-CN'\n          this.$i18n.locale = this.lang\n        }\n        console.log(211212,testData)\n        //return\n        //this.setLang('zh-cn');\n\n        //this.setLang('en-us');\n        // if (this.lang === 'zh-CN') {\n        //   this.lang = 'en-US'\n        //   this.$i18n.locale = this.lang\n        // } else {\n        //   this.lang = 'zh-CN'\n        //   this.$i18n.locale = this.lang\n        // }\n        //return;\n        let dialog = this.$common.dialog1, data={name:this.$lang('status')};\n        alert(data.name)\n        // dialog.loading();\n         // dialog.toast('xww');\n         //return\n        dialog.open({\n          title : '编辑任务名称',\n          content : '<div>任务名称：</div>' +\n                  '<textarea style=\"width:400px; height: 100px; resize: both;\" placeholder=\"请在此输入任务名称\" v-model=\"name\">' +\n                  '</textarea>',\n          data : data,\n          // type : \"save\",\n\n          btns : [\n            {\n              value : '取消',\n              action(obj){\n                dialog.close();\n              }\n            },\n            {\n              value : '确认',\n              primary : true,\n              action(obj){\n                dialog.close();\n              }\n            }\n          ]\n        })\n      },\n      touchstart(e) {\n        console.log(1,e);\n        e.preventDefault();//阻止默认事件（长按的时候出现复制）\n        this.startY = e.touches[0].pageY;\n      },\n      touchend(e) {\n        e.preventDefault();\n        let endY = e.changedTouches[0].pageY;\n        let dy = endY - this.startY;\n        if (dy > 0 && !this.isBottom) {\n          alert('top to bottom');\n        } else if(dy < 0 && this.isBottom){\n          alert('2')\n        }else {\n          return\n        }\n        this.isBottom = !this.isBottom;\n      },\n      // 搜索\n      handleSearch () {\n        if (this.searchKey) {\n          this.placeSearch.search(this.searchKey)\n        }\n      },\n      // 实例化地图\n      initMap () {\n          let dialog = this.$common.dialog1, data={name:''};\n          //dialog.loading();\n        // 加载PositionPicker，loadUI的路径参数为模块名中 'ui/' 之后的部分\n        let AMapUI = this.AMapUI = window.AMapUI\n        let AMap = this.AMap = window.AMap\n        AMapUI.loadUI(['misc/PositionPicker'], PositionPicker => {\n            dialog.close();\n          let mapConfig = {\n            zoom: 16,\n            cityName: MapCityName,\n            lang: \"en\",\n          }\n          if (this.lat && this.lng) {\n            mapConfig.center = [this.lng, this.lat]\n          }\n          let map = new AMap.Map('js-container', mapConfig)\n          // 加载地图搜索插件\n          AMap.service('AMap.PlaceSearch', () => {\n            this.placeSearch = new AMap.PlaceSearch({\n              pageSize: 5,\n              pageIndex: 1,\n              citylimit: true,\n              city: MapCityName,\n              map: map,\n              panel: 'js-result',\n\n            })\n          })\n          // 启用工具条\n          // AMap.plugin(['AMap.ToolBar'], function () {\n          //   map.addControl(new AMap.ToolBar({\n          //     position: 'RB'\n          //   }))\n          // })\n          // 创建地图拖拽\n          let positionPicker = new PositionPicker({\n            mode: 'dragMarker', // 设定为拖拽地图模式，可选'dragMap'、'dragMarker'，默认为'dragMap'\n            map: map // 依赖地图对象\n          })\n          // 拖拽完成发送自定义 drag 事件\n          positionPicker.on('success', positionResult => {\n            // 过滤掉初始化地图后的第一次默认拖放\n            if (!this.dragStatus) {\n              this.dragStatus = true\n            } else {\n              this.$emit('drag', positionResult);\n              console.log(positionResult)\n            }\n          })\n          // 启动拖放\n          positionPicker.start()\n        })\n      }\n    },\n    async created () {\n      // 已载入高德地图API，则直接初始化地图\n\n      if (window.AMap && window.AMapUI) {\n        this.initMap()\n        // 未载入高德地图API，则先载入API再初始化\n      } else {\n        await remoteLoad(`http://webapi.amap.com/maps?v=1.3&key=${MapKey}&language=en`)\n        await remoteLoad('http://webapi.amap.com/ui/1.0/main.js')\n        this.initMap()\n      }\n    }\n  }\n</script>\n\n<style lang=\"less\" scoped>\n@import \"../assets/css/var.less\";\n  .m-map{\n    height: 100vh;\n    width: 100vh;\n    .map{\n      width: 100vh;\n      height: 100vh;\n    }\n\n  }\n  .input_card{\n    position: absolute;\n    background-color: white;\n    filter: opacity(0.8);\n    height: 40vh;\n    width: 100vh;\n    bottom: 0;\n    border-radius: 20px 20px 0 0;\n    z-index: 9999;\n    font-weight: bold;\n    .duration();\n\n  }\n  .top_location{\n    top: 10px;\n    height: 100%;\n  }\n.input_card1{\n  position: absolute;\n  height: 40vh;\n  width: 100vh;\n  bottom: 0;\n  border-radius: 20px 20px 0 0;\n  z-index: 998;\n  .blur(3px);\n}\n</style>\n"]}]}