{"remainingRequest":"/Users/erin/project/hello-world/testSrc/node_modules/babel-loader/lib/index.js!/Users/erin/project/hello-world/testSrc/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/erin/project/hello-world/testSrc/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/erin/project/hello-world/testSrc/src/components/mapDrag.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/erin/project/hello-world/testSrc/src/components/mapDrag.vue","mtime":1611765541808},{"path":"/Users/erin/project/hello-world/testSrc/node_modules/cache-loader/dist/cjs.js","mtime":1611492586366},{"path":"/Users/erin/project/hello-world/testSrc/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/erin/project/hello-world/testSrc/node_modules/cache-loader/dist/cjs.js","mtime":1611492586366},{"path":"/Users/erin/project/hello-world/testSrc/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/erin/project/hello-world/testSrc/node_modules/@babel/runtime/helpers/builtin/es6/asyncToGenerator\";\nimport \"core-js/modules/es6.regexp.search\";\nimport \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport remoteLoad from '@/utils/remoteLoad.js';\nimport { MapKey, MapCityName } from '@/config/config';\nimport testData from '@/mock.js';\nimport dialog from \"../utils/dialog\";\nexport default {\n  props: ['lat', 'lng'],\n  data: function data() {\n    return {\n      searchKey: '',\n      placeSearch: null,\n      dragStatus: false,\n      AMapUI: null,\n      AMap: null,\n      startY: 0,\n      isBottom: true,\n      lang: 'zh-CN'\n    };\n  },\n  watch: {\n    searchKey: function searchKey() {\n      if (this.searchKey === '') {\n        this.placeSearch.clear();\n      }\n    }\n  },\n  mounted: function mounted() {},\n  methods: {\n    setLang: function setLang(lang) {\n      this.$common.setLang(lang);\n      this.$forceUpdate();\n    },\n    testDialog: function testDialog() {\n      if (this.lang === 'zh-CN') {\n        this.lang = 'en-US';\n        this.$i18n.locale = this.lang;\n      } else {\n        this.lang = 'zh-CN';\n        this.$i18n.locale = this.lang;\n      }\n\n      console.log(211212, testData); //return\n      //this.setLang('zh-cn');\n      //this.setLang('en-us');\n      // if (this.lang === 'zh-CN') {\n      //   this.lang = 'en-US'\n      //   this.$i18n.locale = this.lang\n      // } else {\n      //   this.lang = 'zh-CN'\n      //   this.$i18n.locale = this.lang\n      // }\n      //return;\n\n      var dialog = this.$common.dialog1,\n          data = {\n        name: this.$lang('status')\n      };\n      alert(data.name); // dialog.loading();\n      // dialog.toast('xww');\n      //return\n\n      dialog.open({\n        title: '编辑任务名称',\n        content: '<div>任务名称：</div>' + '<textarea style=\"width:400px; height: 100px; resize: both;\" placeholder=\"请在此输入任务名称\" v-model=\"name\">' + '</textarea>',\n        data: data,\n        // type : \"save\",\n        btns: [{\n          value: '取消',\n          action: function action(obj) {\n            dialog.close();\n          }\n        }, {\n          value: '确认',\n          primary: true,\n          action: function action(obj) {\n            dialog.close();\n          }\n        }]\n      });\n    },\n    touchstart: function touchstart(e) {\n      console.log(1, e);\n      e.preventDefault(); //阻止默认事件（长按的时候出现复制）\n\n      this.startY = e.touches[0].pageY;\n    },\n    touchend: function touchend(e) {\n      e.preventDefault();\n      var endY = e.changedTouches[0].pageY;\n      var dy = endY - this.startY;\n\n      if (dy > 0 && !this.isBottom) {\n        alert('top to bottom');\n      } else if (dy < 0 && this.isBottom) {\n        alert('2');\n      } else {\n        return;\n      }\n\n      this.isBottom = !this.isBottom;\n    },\n    // 搜索\n    handleSearch: function handleSearch() {\n      if (this.searchKey) {\n        this.placeSearch.search(this.searchKey);\n      }\n    },\n    // 实例化地图\n    initMap: function initMap() {\n      var _this = this;\n\n      var dialog = this.$common.dialog1,\n          data = {\n        name: ''\n      }; //dialog.loading();\n      // 加载PositionPicker，loadUI的路径参数为模块名中 'ui/' 之后的部分\n\n      var AMapUI = this.AMapUI = window.AMapUI;\n      var AMap = this.AMap = window.AMap;\n      AMapUI.loadUI(['misc/PositionPicker'], function (PositionPicker) {\n        dialog.close();\n        var mapConfig = {\n          zoom: 16,\n          cityName: MapCityName,\n          lang: \"en\"\n        };\n\n        if (_this.lat && _this.lng) {\n          mapConfig.center = [_this.lng, _this.lat];\n        }\n\n        var map = new AMap.Map('js-container', mapConfig); // 加载地图搜索插件\n\n        AMap.service('AMap.PlaceSearch', function () {\n          _this.placeSearch = new AMap.PlaceSearch({\n            pageSize: 5,\n            pageIndex: 1,\n            citylimit: true,\n            city: MapCityName,\n            map: map,\n            panel: 'js-result'\n          });\n        }); // 启用工具条\n        // AMap.plugin(['AMap.ToolBar'], function () {\n        //   map.addControl(new AMap.ToolBar({\n        //     position: 'RB'\n        //   }))\n        // })\n        // 创建地图拖拽\n\n        var positionPicker = new PositionPicker({\n          mode: 'dragMarker',\n          // 设定为拖拽地图模式，可选'dragMap'、'dragMarker'，默认为'dragMap'\n          map: map // 依赖地图对象\n\n        }); // 拖拽完成发送自定义 drag 事件\n\n        positionPicker.on('success', function (positionResult) {\n          // 过滤掉初始化地图后的第一次默认拖放\n          if (!_this.dragStatus) {\n            _this.dragStatus = true;\n          } else {\n            _this.$emit('drag', positionResult);\n\n            console.log(positionResult);\n          }\n        }); // 启动拖放\n\n        positionPicker.start();\n      });\n    }\n  },\n  created: function () {\n    var _created = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee() {\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!(window.AMap && window.AMapUI)) {\n                _context.next = 4;\n                break;\n              }\n\n              this.initMap(); // 未载入高德地图API，则先载入API再初始化\n\n              _context.next = 9;\n              break;\n\n            case 4:\n              _context.next = 6;\n              return remoteLoad(\"http://webapi.amap.com/maps?v=1.3&key=\".concat(MapKey, \"&language=en\"));\n\n            case 6:\n              _context.next = 8;\n              return remoteLoad('http://webapi.amap.com/ui/1.0/main.js');\n\n            case 8:\n              this.initMap();\n\n            case 9:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    return function created() {\n      return _created.apply(this, arguments);\n    };\n  }()\n};",{"version":3,"sources":["mapDrag.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkCA,OAAA,UAAA,MAAA,uBAAA;AACA,SAAA,MAAA,EAAA,WAAA,QAAA,iBAAA;AACA,OAAA,QAAA,MAAA,WAAA;AACA,OAAA,MAAA,MAAA,iBAAA;AACA,eAAA;AACA,SAAA,CAAA,KAAA,EAAA,KAAA,CADA;AAEA,MAFA,kBAEA;AACA,WAAA;AACA,iBAAA,EADA;AAEA,mBAAA,IAFA;AAGA,kBAAA,KAHA;AAIA,cAAA,IAJA;AAKA,YAAA,IALA;AAMA,cAAA,CANA;AAOA,gBAAA,IAPA;AAQA,YAAA;AARA,KAAA;AAUA,GAbA;AAcA,SAAA;AACA,aADA,uBACA;AACA,UAAA,KAAA,SAAA,KAAA,EAAA,EAAA;AACA,aAAA,WAAA,CAAA,KAAA;AACA;AACA;AALA,GAdA;AAqBA,SArBA,qBAqBA,CAEA,CAvBA;AAwBA,WAAA;AACA,WADA,mBACA,IADA,EACA;AACA,WAAA,OAAA,CAAA,OAAA,CAAA,IAAA;AACA,WAAA,YAAA;AACA,KAJA;AAKA,cALA,wBAKA;AACA,UAAA,KAAA,IAAA,KAAA,OAAA,EAAA;AACA,aAAA,IAAA,GAAA,OAAA;AACA,aAAA,KAAA,CAAA,MAAA,GAAA,KAAA,IAAA;AACA,OAHA,MAGA;AACA,aAAA,IAAA,GAAA,OAAA;AACA,aAAA,KAAA,CAAA,MAAA,GAAA,KAAA,IAAA;AACA;;AACA,cAAA,GAAA,CAAA,MAAA,EAAA,QAAA,EARA,CASA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,UAAA,SAAA,KAAA,OAAA,CAAA,OAAA;AAAA,UAAA,OAAA;AAAA,cAAA,KAAA,KAAA,CAAA,QAAA;AAAA,OAAA;AACA,YAAA,KAAA,IAAA,EAtBA,CAuBA;AACA;AACA;;AACA,aAAA,IAAA,CAAA;AACA,eAAA,QADA;AAEA,iBAAA,qBACA,qGADA,GAEA,aAJA;AAKA,cAAA,IALA;AAMA;AAEA,cAAA,CACA;AACA,iBAAA,IADA;AAEA,gBAFA,kBAEA,GAFA,EAEA;AACA,mBAAA,KAAA;AACA;AAJA,SADA,EAOA;AACA,iBAAA,IADA;AAEA,mBAAA,IAFA;AAGA,gBAHA,kBAGA,GAHA,EAGA;AACA,mBAAA,KAAA;AACA;AALA,SAPA;AARA,OAAA;AAwBA,KAvDA;AAwDA,cAxDA,sBAwDA,CAxDA,EAwDA;AACA,cAAA,GAAA,CAAA,CAAA,EAAA,CAAA;AACA,QAAA,cAAA,GAFA,CAEA;;AACA,WAAA,MAAA,GAAA,EAAA,OAAA,CAAA,CAAA,EAAA,KAAA;AACA,KA5DA;AA6DA,YA7DA,oBA6DA,CA7DA,EA6DA;AACA,QAAA,cAAA;AACA,UAAA,OAAA,EAAA,cAAA,CAAA,CAAA,EAAA,KAAA;AACA,UAAA,KAAA,OAAA,KAAA,MAAA;;AACA,UAAA,KAAA,CAAA,IAAA,CAAA,KAAA,QAAA,EAAA;AACA,cAAA,eAAA;AACA,OAFA,MAEA,IAAA,KAAA,CAAA,IAAA,KAAA,QAAA,EAAA;AACA,cAAA,GAAA;AACA,OAFA,MAEA;AACA;AACA;;AACA,WAAA,QAAA,GAAA,CAAA,KAAA,QAAA;AACA,KAzEA;AA0EA;AACA,gBA3EA,0BA2EA;AACA,UAAA,KAAA,SAAA,EAAA;AACA,aAAA,WAAA,CAAA,MAAA,CAAA,KAAA,SAAA;AACA;AACA,KA/EA;AAgFA;AACA,WAjFA,qBAiFA;AAAA;;AACA,UAAA,SAAA,KAAA,OAAA,CAAA,OAAA;AAAA,UAAA,OAAA;AAAA,cAAA;AAAA,OAAA,CADA,CAEA;AACA;;AACA,UAAA,SAAA,KAAA,MAAA,GAAA,OAAA,MAAA;AACA,UAAA,OAAA,KAAA,IAAA,GAAA,OAAA,IAAA;AACA,aAAA,MAAA,CAAA,CAAA,qBAAA,CAAA,EAAA,0BAAA;AACA,eAAA,KAAA;AACA,YAAA,YAAA;AACA,gBAAA,EADA;AAEA,oBAAA,WAFA;AAGA,gBAAA;AAHA,SAAA;;AAKA,YAAA,MAAA,GAAA,IAAA,MAAA,GAAA,EAAA;AACA,oBAAA,MAAA,GAAA,CAAA,MAAA,GAAA,EAAA,MAAA,GAAA,CAAA;AACA;;AACA,YAAA,MAAA,IAAA,KAAA,GAAA,CAAA,cAAA,EAAA,SAAA,CAAA,CAVA,CAWA;;AACA,aAAA,OAAA,CAAA,kBAAA,EAAA,YAAA;AACA,gBAAA,WAAA,GAAA,IAAA,KAAA,WAAA,CAAA;AACA,sBAAA,CADA;AAEA,uBAAA,CAFA;AAGA,uBAAA,IAHA;AAIA,kBAAA,WAJA;AAKA,iBAAA,GALA;AAMA,mBAAA;AANA,WAAA,CAAA;AASA,SAVA,EAZA,CAuBA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,YAAA,iBAAA,IAAA,cAAA,CAAA;AACA,gBAAA,YADA;AACA;AACA,eAAA,GAFA,CAEA;;AAFA,SAAA,CAAA,CA9BA,CAkCA;;AACA,uBAAA,EAAA,CAAA,SAAA,EAAA,0BAAA;AACA;AACA,cAAA,CAAA,MAAA,UAAA,EAAA;AACA,kBAAA,UAAA,GAAA,IAAA;AACA,WAFA,MAEA;AACA,kBAAA,KAAA,CAAA,MAAA,EAAA,cAAA;;AACA,oBAAA,GAAA,CAAA,cAAA;AACA;AACA,SARA,EAnCA,CA4CA;;AACA,uBAAA,KAAA;AACA,OA9CA;AA+CA;AAtIA,GAxBA;AAgKA,SAhKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAmKA,OAAA,IAAA,IAAA,OAAA,MAnKA;AAAA;AAAA;AAAA;;AAoKA,mBAAA,OAAA,GApKA,CAqKA;;AArKA;AAAA;;AAAA;AAAA;AAAA,qBAuKA,2DAAA,MAAA,kBAvKA;;AAAA;AAAA;AAAA,qBAwKA,WAAA,uCAAA,CAxKA;;AAAA;AAyKA,mBAAA,OAAA;;AAzKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,CAAA","sourcesContent":["<!--\n  描述：拖放地图组件，默认尺寸是 500 * 300\n\n  接收属性参数：\n    lat: 纬度\n    lng: 经度\n\n  自定义事件：\n    drag: 拖放完成事件\n\n  示例：\n    <mapDrag @drag=\"dragMap\" lat=\"22.574405\" lng=\"114.095388\"></mapDrag>\n-->\n<template>\n  <div>\n    <div class=\"m-map\">\n      <div id=\"js-container\" class=\"map\">\n        正在加载数据 ...\n      </div>\n\n    </div>\n    <div  @click=\"testDialog\">测试dialog</div>\n\n    <div class=\"input_card\"  @touchstart=\"touchstart\" @touchend=\"touchend\" :class=\"{'top_location':!isBottom}\" >\n      测试ing\n      毛玻璃效果\n      <div>{{$lang('userName')}}</div>\n      <div>{{$lang('message')}}</div>----{{$t('status')}}\n    </div>\n    <div class=\"input_card1\" ref=\"card\"  @touchstart=\"touchstart\" @touchend=\"touchend\" :class=\"{'top_location':!isBottom}\"></div>\n  </div>\n</template>\n\n<script>\n  import remoteLoad from '@/utils/remoteLoad.js'\n  import { MapKey, MapCityName } from '@/config/config'\n  import testData from  '@/mock.js'\n  import dialog from \"../utils/dialog\";\n  export default {\n    props: ['lat', 'lng'],\n    data () {\n      return {\n        searchKey: '',\n        placeSearch: null,\n        dragStatus: false,\n        AMapUI: null,\n        AMap: null,\n        startY:0,\n        isBottom:true,\n        lang: 'zh-CN'\n      }\n    },\n    watch: {\n      searchKey () {\n        if (this.searchKey === '') {\n          this.placeSearch.clear()\n        }\n      }\n    },\n    mounted(){\n\n    },\n    methods: {\n      setLang(lang){\n        this.$common.setLang(lang);\n        this.$forceUpdate();\n      },\n      testDialog(){\n        if (this.lang === 'zh-CN') {\n          this.lang = 'en-US'\n          this.$i18n.locale = this.lang\n        } else {\n          this.lang = 'zh-CN'\n          this.$i18n.locale = this.lang\n        }\n        console.log(211212,testData)\n        //return\n        //this.setLang('zh-cn');\n\n        //this.setLang('en-us');\n        // if (this.lang === 'zh-CN') {\n        //   this.lang = 'en-US'\n        //   this.$i18n.locale = this.lang\n        // } else {\n        //   this.lang = 'zh-CN'\n        //   this.$i18n.locale = this.lang\n        // }\n        //return;\n        let dialog = this.$common.dialog1, data={name:this.$lang('status')};\n        alert(data.name)\n        // dialog.loading();\n         // dialog.toast('xww');\n         //return\n        dialog.open({\n          title : '编辑任务名称',\n          content : '<div>任务名称：</div>' +\n                  '<textarea style=\"width:400px; height: 100px; resize: both;\" placeholder=\"请在此输入任务名称\" v-model=\"name\">' +\n                  '</textarea>',\n          data : data,\n          // type : \"save\",\n\n          btns : [\n            {\n              value : '取消',\n              action(obj){\n                dialog.close();\n              }\n            },\n            {\n              value : '确认',\n              primary : true,\n              action(obj){\n                dialog.close();\n              }\n            }\n          ]\n        })\n      },\n      touchstart(e) {\n        console.log(1,e);\n        e.preventDefault();//阻止默认事件（长按的时候出现复制）\n        this.startY = e.touches[0].pageY;\n      },\n      touchend(e) {\n        e.preventDefault();\n        let endY = e.changedTouches[0].pageY;\n        let dy = endY - this.startY;\n        if (dy > 0 && !this.isBottom) {\n          alert('top to bottom');\n        } else if(dy < 0 && this.isBottom){\n          alert('2')\n        }else {\n          return\n        }\n        this.isBottom = !this.isBottom;\n      },\n      // 搜索\n      handleSearch () {\n        if (this.searchKey) {\n          this.placeSearch.search(this.searchKey)\n        }\n      },\n      // 实例化地图\n      initMap () {\n          let dialog = this.$common.dialog1, data={name:''};\n          //dialog.loading();\n        // 加载PositionPicker，loadUI的路径参数为模块名中 'ui/' 之后的部分\n        let AMapUI = this.AMapUI = window.AMapUI\n        let AMap = this.AMap = window.AMap\n        AMapUI.loadUI(['misc/PositionPicker'], PositionPicker => {\n            dialog.close();\n          let mapConfig = {\n            zoom: 16,\n            cityName: MapCityName,\n            lang: \"en\",\n          }\n          if (this.lat && this.lng) {\n            mapConfig.center = [this.lng, this.lat]\n          }\n          let map = new AMap.Map('js-container', mapConfig)\n          // 加载地图搜索插件\n          AMap.service('AMap.PlaceSearch', () => {\n            this.placeSearch = new AMap.PlaceSearch({\n              pageSize: 5,\n              pageIndex: 1,\n              citylimit: true,\n              city: MapCityName,\n              map: map,\n              panel: 'js-result',\n\n            })\n          })\n          // 启用工具条\n          // AMap.plugin(['AMap.ToolBar'], function () {\n          //   map.addControl(new AMap.ToolBar({\n          //     position: 'RB'\n          //   }))\n          // })\n          // 创建地图拖拽\n          let positionPicker = new PositionPicker({\n            mode: 'dragMarker', // 设定为拖拽地图模式，可选'dragMap'、'dragMarker'，默认为'dragMap'\n            map: map // 依赖地图对象\n          })\n          // 拖拽完成发送自定义 drag 事件\n          positionPicker.on('success', positionResult => {\n            // 过滤掉初始化地图后的第一次默认拖放\n            if (!this.dragStatus) {\n              this.dragStatus = true\n            } else {\n              this.$emit('drag', positionResult);\n              console.log(positionResult)\n            }\n          })\n          // 启动拖放\n          positionPicker.start()\n        })\n      }\n    },\n    async created () {\n      // 已载入高德地图API，则直接初始化地图\n\n      if (window.AMap && window.AMapUI) {\n        this.initMap()\n        // 未载入高德地图API，则先载入API再初始化\n      } else {\n        await remoteLoad(`http://webapi.amap.com/maps?v=1.3&key=${MapKey}&language=en`)\n        await remoteLoad('http://webapi.amap.com/ui/1.0/main.js')\n        this.initMap()\n      }\n    }\n  }\n</script>\n\n<style lang=\"less\" scoped>\n@import \"../assets/css/var.less\";\n  .m-map{\n    height: 100vh;\n    width: 100vh;\n    .map{\n      width: 100vh;\n      height: 100vh;\n    }\n\n  }\n  .input_card{\n    position: absolute;\n    background-color: white;\n    filter: opacity(0.8);\n    height: 40vh;\n    width: 100vh;\n    bottom: 0;\n    border-radius: 20px 20px 0 0;\n    z-index: 9999;\n    font-weight: bold;\n    .duration();\n\n  }\n  .top_location{\n    top: 10px;\n    height: 100%;\n  }\n.input_card1{\n  position: absolute;\n  height: 40vh;\n  width: 100vh;\n  bottom: 0;\n  border-radius: 20px 20px 0 0;\n  z-index: 998;\n  .blur(3px);\n}\n</style>\n"],"sourceRoot":"src/components"}]}